<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>R Literacy &#8211; Smart Digital Agriculture</title>
<meta name="description" content="Part 8">


<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/">
<meta name="twitter:title" content="R Literacy">
<meta name="twitter:description" content="Part 8">
<meta name="twitter:creator" content="@soilmalone">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="R Literacy">
<meta property="og:description" content="Part 8">
<meta property="og:url" content="/DSM_book/pages/r_literacy/part8/">
<meta property="og:site_name" content="Smart Digital Agriculture">

<meta name="google-site-verification" content="googledd99b1430269a639.html">



<link rel="canonical" href="/DSM_book/pages/r_literacy/part8/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Smart Digital Agriculture Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<!-- Bootstrap Core CSS -->
<link rel="stylesheet" href="/assets/css/bootstrap.min.css">
<!-- Clean Blog CSS -->
<link rel="stylesheet" href="/assets/css/clean-blog.css">
<!-- HPSTR main CSS -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Custom Fonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">
<link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Viga|Ubuntu:700' rel='stylesheet' type='text/css'>
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

</head>

<body id="page" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Smart Digital Agriculture</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    
                    <li><a href="/" >Home</a></li>
                
                    
                    <li><a href="/publications/" >Publications</a></li>
                
                    
                    <li><a href="/software/" >Software</a></li>
                
                    
                    <li><a href="/blog/" >Journal Digests</a></li>
                
                    
                    <li><a href="/UseCases/" >Blog</a></li>
                
                    
                    <li><a href="/DSM_book/" >Using R for Digital Soil Mapping</a></li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

<!-- Page Header -->
<header class="intro-header" style="background-image: url('/images/pedometric2017.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="site-heading">
                    <h1>R Literacy</h1>
                    
                        <hr class="small">
                        <span class="subheading">Part 8</span>
                    
                </div>
            </div>
        </div>
    </div>
</header>

<!--

-->

<div id="main" role="main">
  <article class="hentry">
    <!--
    <header class="header-title">
      <div class="header-title-wrap">
        <h1 class="entry-title">R Literacy</h1>
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
          Reading time ~23 minutes
        </p>
        
      </div>
    </header>
    -->
    <div class="entry-content">
      <p>Code is <a href="/DSM_book/rcode/intro2R/P3_Intro_R_2017_Part8.R">here</a></p>

<h2 id="logical-thinking-and-algorithm-development">Logical thinking and algorithm development</h2>

<p>One of the advantages of using a scripting language, such as <code class="highlighter-rouge">R</code> is that
we can develop algorithms or script a set of commands for
problem-solving. We illustrate this by developing an algorithm for
generating a catena, or more correctly, a digital toposequence from a
digital elevation model (DEM). To make it more interesting, we will not
use any function from external libraries other than basic <code class="highlighter-rouge">R</code> functions.
Before scripting, it is best to write out the algorithm or sequence of
routines to use.</p>

<p>A toposequence can be described as a transect (not necessarily a
straight line) which begins at a hilltop and ends at a valley bottom or
a stream (Odgers, McBratney, and Minasny 2008). To generate a principal
toposequence, one can start from the highest point in an area. If we
numerically consider a rainfall as a discrete packet of <em>precipitation</em>
that falls on the highest elevation pixel, then this precipitation will
mostly move to its neighbor with the highest slope. As DEM is stored in
matrix format, we simply look around its 3 x 3 neighbors and determine
which pixel is the lowest elevation. The algorithm for principal
toposequence can be written as:</p>

<ol>
  <li>Determine the highest point in an area.</li>
  <li>Determine its 3 x 3 neighbor, and determine whether there are lower
points?</li>
  <li>If yes, set the lowest point as the next point in the toposequence,
and then repeat step 2. If no, the toposequence has ended.</li>
</ol>

<p>To facilitate the 3 x 3 neighbor search in <code class="highlighter-rouge">R</code>, we can code the
neighbors using its relative coordinates. If the current cell is
designated as [0,0], then its left neighbor is [−1,0], and so
on. We can visualize it as follows in the below figure.</p>

<figure>
    <img src="/images/dsm_book/topo1.png" alt="rconsole" />
    <figcaption> Indexation of 3 x 3 neighborhood.</figcaption>
</figure>

<p>If we designate the current cell [0,0] as <code class="highlighter-rouge">z1</code>, the function below
will look for the lowest neighbor for pixel <code class="highlighter-rouge">z1</code> in a DEM.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="c1"># function to find the lowest 3 x 3 neighbor</span><span class="w">
    </span><span class="n">find_steepest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span><span class="w"> </span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">  </span><span class="c1">#elevation </span><span class="w">
        </span><span class="c1"># return the elevation of the neighboring values</span><span class="w">
        </span><span class="n">dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1">#neighborhood index</span><span class="w">
        </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span><span class="w">
        </span><span class="n">nc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncol</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span><span class="w">
        </span><span class="n">pz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">  </span><span class="c1">#placeholder for the values</span><span class="w">
        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="n">ro</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
                    </span><span class="n">co</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w">
                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ro</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">co</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">co</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                      </span><span class="n">pz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dem</span><span class="p">[</span><span class="n">ro</span><span class="p">,</span><span class="w"> </span><span class="n">co</span><span class="p">]</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
        
        </span><span class="n">pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">  </span><span class="c1"># difference of neighbors from centre value</span><span class="w">
        </span><span class="c1"># find lowest value</span><span class="w">
        </span><span class="n">min_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">pz</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">arr.ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
        </span><span class="n">row_min</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">min_pz</span><span class="p">[</span><span class="m">1</span><span class="p">]]</span><span class="w">
        </span><span class="n">col_min</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">min_pz</span><span class="p">[</span><span class="m">2</span><span class="p">]]</span><span class="w">
        </span><span class="n">retval</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">row_min</span><span class="p">,</span><span class="w"> </span><span class="n">col_min</span><span class="p">,</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w">
        </span><span class="nf">return</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span><span class="w">  </span><span class="c1">#return the minimum</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The principal toposequence code can be implemented as follows. First we
load in a small dataset called <code class="highlighter-rouge">topo_dem</code> from the <code class="highlighter-rouge">ithir</code> package.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">library</span><span class="p">(</span><span class="n">ithir</span><span class="p">)</span><span class="w">
    </span><span class="n">data</span><span class="p">(</span><span class="n">topo_dem</span><span class="p">)</span><span class="w">
    </span><span class="n">str</span><span class="p">(</span><span class="n">topo_dem</span><span class="p">)</span><span class="w">

    </span><span class="c1">##  num [1:109, 1:110] 121 121 120 118 116 ...</span><span class="w">
    </span><span class="c1">##  - attr(*, "dimnames")=List of 2</span><span class="w">
    </span><span class="c1">##   ..$ : NULL</span><span class="w">
    </span><span class="c1">##   ..$ : chr [1:110] "V1" "V2" "V3" "V4" ...</span><span class="w">
</span></code></pre></div></div>

<p>Now we want to create a data matrix to store the result of the
toposequence i.e. the row, column, and elevation values that are
selected using the <code class="highlighter-rouge">find_steepest</code> function.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">transect</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Now we want to find within that matrix that maximum elevation value and
its corresponding row and column position.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">max_elev</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">topo_dem</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">topo_dem</span><span class="p">),</span><span class="w"> </span><span class="n">arr.ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
    </span><span class="n">row_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max_elev</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">  </span><span class="c1"># row of max_elev</span><span class="w">
    </span><span class="n">col_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max_elev</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">  </span><span class="c1"># col of max_elev</span><span class="w">
    </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">  </span><span class="c1"># max elevation</span><span class="w">

    </span><span class="c1"># Put values into the first entry of the transect object</span><span class="w">
    </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">
    </span><span class="n">transect</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_z</span><span class="w">
    </span><span class="n">transect</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_z</span><span class="w">
    </span><span class="n">transect</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">
    </span><span class="n">lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="w">
</span></code></pre></div></div>

<p>Below we use the <code class="highlighter-rouge">find_steepest</code> function. It is embedded into a <code class="highlighter-rouge">while</code>
conditional loop, such that the routine will run until neither of the
surrounding neighbors are less than the middle pixel or <code class="highlighter-rouge">z1</code>. We use the
<code class="highlighter-rouge">break</code> function to stop the routine when this occurs. Essentially, upon
each iteration, we use the selected <code class="highlighter-rouge">z1</code> to find the lowest value pixel
from it, which in turn becomes the next selected <code class="highlighter-rouge">z1</code> and so on until
the values of the neighborhood are no longer smaller than the selected
<code class="highlighter-rouge">z1</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="c1"># iterate down the hill until lowest point</span><span class="w">
    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">lowest</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">find_steepest</span><span class="p">(</span><span class="n">dem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">,</span><span class="w"> </span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">)</span><span class="w">  </span><span class="c1"># find steepest neighbor</span><span class="w">
        </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="w">
        </span><span class="n">row_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
        </span><span class="n">col_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">
        </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">
        </span><span class="n">transect</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_z</span><span class="w">
        </span><span class="n">transect</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_z</span><span class="w">
        </span><span class="n">transect</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> 
            </span><span class="p">{</span><span class="w">
                </span><span class="n">lowest</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">
                </span><span class="k">break</span><span class="w">
            </span><span class="p">}</span><span class="w">  </span><span class="c1"># if found lowest point</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Finally we can plot the transect. First lets calculate a distance
relative to the top of the transect. After this we can generate a plot
below.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">((</span><span class="n">transect</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">transect</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="p">])</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">transect</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">transect</span><span class="p">[,</span><span class="w"> </span><span class="m">2</span><span class="p">])</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
    </span><span class="n">plot</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="w"> </span><span class="n">transect</span><span class="p">[,</span><span class="w"> </span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Distance (m)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Elevation (m)"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<figure>
    <img src="/images/dsm_book/topo2.png" alt="rconsole" />
    <figcaption> Generated toposequence using the `find_steepest` function.</figcaption>
</figure>

<p>So let’s take this a step further and consider the idea of a random
toposequence. In reality, water does not only flow in the steepest
direction, water can potentially move down to any lower elevation. And,
a toposequence does not necessarily start at the highest elevation
either. We can generate a random toposequence (Odgers, McBratney, and
Minasny 2008), where we select a random point in the landscape, then
find a random path to the top and bottom of a hillslope. In addition to
the downhill routine, we need an uphill routine too.</p>

<p>The algorithm for the random toposequence could be written as:</p>

<ol>
  <li>
    <p>Select a random point from a DEM.</p>
  </li>
  <li>
    <p>Travel uphill:</p>
  </li>
</ol>

<p>a. Determine its 3 x 3 neighbor, and determine whether there are higher
    points?
b. If yes, select randomly a higher point, add to the uphill sequence,
    and repeat step 2a. If this point is the highest, the uphill
    sequence ended.</p>

<ol>
  <li>Travel downhill:</li>
</ol>

<p>a. Determine its 3 x 3 neighbor, and determine whether there are lower
    points?
b. If yes, select randomly a lower point, add to the downhill sequence,
    and repeat step 3a. If this point is the lowest or reached a stream,
    the downhill sequence ended.</p>

<p>From this algorithm plan, we need to specify two functions, one that
allows the transect to travel uphill and another which allows it to
travel downhill. For the one to travel downhill, we could use the
function from before <code class="highlighter-rouge">find_steepest</code>, but we want to build on that
function by allowing the user to indicate whether they want a randomly
selected smaller values, or whether they want to minimum every time.
Subsequently the 2 new functions would take the following form:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">travel_down</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span><span class="w"> </span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="p">)</span><span class="w"> </span><span class="c1"># function to simulate water moving down the slope input: dem and its row &amp;</span><span class="w">
    </span><span class="c1"># column random: TRUE use random path, FALSE for steepest path return:</span><span class="w">
    </span><span class="c1"># row,col,z-z1 of lower neighbour</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">
        </span><span class="c1"># find its eight neighbour</span><span class="w">
        </span><span class="n">dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
        </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span><span class="w">
        </span><span class="n">nc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncol</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span><span class="w">
        </span><span class="n">pz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="n">ro</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
                </span><span class="n">co</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w">
                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ro</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">co</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">co</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="n">pz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dem</span><span class="p">[</span><span class="n">ro</span><span class="p">,</span><span class="w"> </span><span class="n">co</span><span class="p">]</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="n">pz</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="w">
        </span><span class="n">pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">  </span><span class="c1"># difference with centre value</span><span class="w">
        
        </span><span class="n">min_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">pz</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">arr.ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
        </span><span class="n">nlow</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">min_pz</span><span class="p">)</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nlow</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">min_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">pz</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">arr.ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">random</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c1"># find random lower value</span><span class="w">
                </span><span class="n">ir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample.int</span><span class="p">(</span><span class="n">nlow</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
                </span><span class="n">min_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">min_pz</span><span class="p">[</span><span class="n">ir</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c1"># find lowest value</span><span class="w">
                </span><span class="n">min_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">pz</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">arr.ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="n">row_min</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">min_pz</span><span class="p">[</span><span class="m">1</span><span class="p">]]</span><span class="w">
        </span><span class="n">col_min</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">min_pz</span><span class="p">[</span><span class="m">2</span><span class="p">]]</span><span class="w">
        </span><span class="n">z_min</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dem</span><span class="p">[</span><span class="n">row_min</span><span class="p">,</span><span class="w"> </span><span class="n">col_min</span><span class="p">]</span><span class="w">
        </span><span class="n">retval</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">row_min</span><span class="p">,</span><span class="w"> </span><span class="n">col_min</span><span class="p">,</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w">
        </span><span class="nf">return</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">


    </span><span class="n">travel_up</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span><span class="w"> </span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="p">)</span><span class="w"> </span><span class="c1"># function to trace water coming from up hill input: dem and its row &amp; column</span><span class="w">
    </span><span class="c1"># random: TRUE use random path, FALSE for steepest path return: row,col,z-zi of</span><span class="w">
    </span><span class="c1"># higher neighbour</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">
        </span><span class="c1"># find its eight neighbour</span><span class="w">
        </span><span class="n">dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
        </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span><span class="w">
        </span><span class="n">nc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncol</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span><span class="w">
        </span><span class="n">pz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="n">ro</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
                </span><span class="n">co</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w">
                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ro</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">co</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">co</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="n">pz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dem</span><span class="p">[</span><span class="n">ro</span><span class="p">,</span><span class="w"> </span><span class="n">co</span><span class="p">]</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="n">pz</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="w">
        </span><span class="n">pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">  </span><span class="c1"># difference with centre value</span><span class="w">
        
        </span><span class="n">max_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">pz</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">arr.ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">  </span><span class="c1"># find higher pixel</span><span class="w">
        </span><span class="n">nhi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">max_pz</span><span class="p">)</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nhi</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">max_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">pz</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">arr.ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">random</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c1"># find random higher value</span><span class="w">
                </span><span class="n">ir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample.int</span><span class="p">(</span><span class="n">nhi</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
                </span><span class="n">max_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">max_pz</span><span class="p">[</span><span class="n">ir</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c1"># find highest value</span><span class="w">
                </span><span class="n">max_pz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">pz</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">arr.ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="n">row_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">max_pz</span><span class="p">[</span><span class="m">1</span><span class="p">]]</span><span class="w">
        </span><span class="n">col_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col_z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dir</span><span class="p">[</span><span class="n">max_pz</span><span class="p">[</span><span class="m">2</span><span class="p">]]</span><span class="w">
        </span><span class="n">retval</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">row_max</span><span class="p">,</span><span class="w"> </span><span class="n">col_max</span><span class="p">,</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w">
        </span><span class="nf">return</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Now we can generate a random toposequence. We will use the same
<code class="highlighter-rouge">topo_dem</code> data as before. First we select a point at random using a
random selection of a row and column value. Keep in mind that the random
point selected here may be different to the one you get because we are
using a random number generator via the <code class="highlighter-rouge">sample.int</code> function.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">topo_dem</span><span class="p">)</span><span class="w">  </span><span class="c1"># no. rows in a DEM</span><span class="w">
    </span><span class="n">nc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ncol</span><span class="p">(</span><span class="n">topo_dem</span><span class="p">)</span><span class="w">  </span><span class="c1"># no. cols in a DEM</span><span class="w">

    </span><span class="c1"># start with a random pixel as seed point</span><span class="w">
    </span><span class="n">row_z1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample.int</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
    </span><span class="n">col_z1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample.int</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>We then can use the <code class="highlighter-rouge">travel_up</code> function to get our transect to go up
the slope.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="c1"># Travel uphill seed point as a starting point</span><span class="w">
    </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">
    </span><span class="n">transect_up</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
    </span><span class="n">row_z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_z1</span><span class="w">
    </span><span class="n">col_z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col_z1</span><span class="w">
    </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">
    </span><span class="n">transect_up</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_z</span><span class="w">
    </span><span class="n">transect_up</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_z</span><span class="w">
    </span><span class="n">transect_up</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">

    </span><span class="n">highest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="w">
    </span><span class="c1"># iterate up the hill until highest point</span><span class="w">
    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">highest</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">travel_up</span><span class="p">(</span><span class="n">dem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">,</span><span class="w"> </span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> 
            </span><span class="p">{</span><span class="w">
                </span><span class="n">highest</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">
                </span><span class="k">break</span><span class="w">
            </span><span class="p">}</span><span class="w">  </span><span class="c1"># if found lowest point  </span><span class="w">
        </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="w">
        </span><span class="n">row_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
        </span><span class="n">col_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">
        </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">
        </span><span class="n">transect_up</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_z</span><span class="w">
        </span><span class="n">transect_up</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_z</span><span class="w">
        </span><span class="n">transect_up</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">transect_up</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">na.omit</span><span class="p">(</span><span class="n">transect_up</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Next we then use the <code class="highlighter-rouge">travel_down</code> function to get our transect to go
down the slope from the seed point.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="c1"># travel downhill create a data matrix to store results</span><span class="w">
    </span><span class="n">transect_down</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
    </span><span class="c1"># starting point</span><span class="w">
    </span><span class="n">row_z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_z1</span><span class="w">
    </span><span class="n">col_z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col_z1</span><span class="w">
    </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">  </span><span class="c1"># a random pixel</span><span class="w">
    </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">
    </span><span class="n">transect_down</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_z</span><span class="w">
    </span><span class="n">transect_down</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_z</span><span class="w">
    </span><span class="n">transect_down</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">
    </span><span class="n">lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="w">

    </span><span class="c1"># iterate down the hill until lowest point</span><span class="w">
    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">lowest</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">travel_down</span><span class="p">(</span><span class="n">dem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">,</span><span class="w"> </span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> 
            </span><span class="p">{</span><span class="w">
                </span><span class="n">lowest</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">
                </span><span class="k">break</span><span class="w">
            </span><span class="p">}</span><span class="w">  </span><span class="c1"># if found lowest point  </span><span class="w">
        </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="w">
        </span><span class="n">row_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
        </span><span class="n">col_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">
        </span><span class="n">z</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo_dem</span><span class="p">[</span><span class="n">row_z</span><span class="p">,</span><span class="w"> </span><span class="n">col_z</span><span class="p">]</span><span class="w">
        </span><span class="n">transect_down</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_z</span><span class="w">
        </span><span class="n">transect_down</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_z</span><span class="w">
        </span><span class="n">transect_down</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="m">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">transect_down</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">na.omit</span><span class="p">(</span><span class="n">transect_down</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The idea then is to bind both uphill and downhill transects into a
single one. Note we are using the <code class="highlighter-rouge">rbind</code> function for this.
Furthermore, we are also using the <code class="highlighter-rouge">order</code> function here to re-arrange
the uphill transect so that the resultant binding will be sequential
from highest to lowest elevation. Finally, we then calculate the
distance relative to the hilltop.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">transect</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">transect_up</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="n">transect_up</span><span class="p">[,</span><span class="w"> </span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">),</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="n">transect_down</span><span class="p">[</span><span class="m">-1</span><span class="p">,</span><span class="w"> 
        </span><span class="p">])</span><span class="w">

    </span><span class="c1"># calculate distance from hilltop</span><span class="w">
    </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">((</span><span class="n">transect</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">transect</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="p">])</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">transect</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">transect</span><span class="p">[,</span><span class="w"> </span><span class="m">2</span><span class="p">])</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The last step is to make the plot of the transect. We can also add the
randomly selected seed point for visualization purposes.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">plot</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="w"> </span><span class="n">transect</span><span class="p">[,</span><span class="w"> </span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="w"> 
        </span><span class="m">120</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Distance (m)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Elevation (m)"</span><span class="p">)</span><span class="w">

    </span><span class="n">points</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">nrow</span><span class="p">(</span><span class="n">transect_up</span><span class="p">)],</span><span class="w"> </span><span class="n">transect</span><span class="p">[</span><span class="n">nrow</span><span class="p">(</span><span class="n">transect_up</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<figure>
    <img src="/images/dsm_book/topo3.png" alt="rconsole" />
    <figcaption> Generated random toposequence. (Red point indicates the random seed point).</figcaption>
</figure>

<h3 id="exercises">Exercises</h3>

<p>After seeing how this algorithm works, you can modify the script to take
in stream networks, and make the toposequence end once it reaches the
stream. You can also add <em>error trapping</em> to handle missing values, and
also in case where the downhill routine ends up in a local depression.
This algorithm also can be used to calculate slope length, distance to a
particular landscape feature (e.g. hedges), and so on.</p>

<h3 id="references">References</h3>

<p>Odgers, N P, A B McBratney, and B. Minasny. 2008. “Generation of
Kth-Order Random Toposequences.” <em>Computers &amp; Geosciences</em> 34 (5):
479–90.</p>

      <footer class="entry-meta">
        <span>Updated on <span class="entry-date date published updated"><time datetime="2020-05-08">May 08, 2020</time></span></span>
        <span class="author vcard"><span class="fn">Smart Digital Agriculture</span></span>
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=/DSM_book/pages/r_literacy/part8/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=/DSM_book/pages/r_literacy/part8/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=/DSM_book/pages/r_literacy/part8/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
    <!--<span>&copy; 2020 Smart Digital Agriculture. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/" rel="notfollow">HPSTR Theme</a>.</span>-->

<footer role="contentinfo">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="mailto:malone.brendan1001@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/brendo1001">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://twitter.com/soilmalone">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Smart Digital Agriculture 2020, All Rights Reserved.</p>
            </div>
        </div>
    </div>
</footer>

</div><!-- /.footer-wrapper -->

<!-- JQuery JavaScript -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>

<!-- Bootstrap Core JavaScript -->
<script src="/assets/js/vendor/bootstrap.min.js"></script>

<!-- Clean Blog JavaScript -->
<script src="/assets/js/clean-blog.min.js"></script>

<script src="/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-87285093-1', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>


<!-- Math equation support by MathJax -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
            equationNumbers: { autoNumber: "all" },
            inlineMath: [['$','$'],['\\(','\\)']],
        },
        "HTML-CSS": {
            availableFonts: ["TeX"],
            preferredFont: "TeX",
        },
    });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>




</body>
</html>
